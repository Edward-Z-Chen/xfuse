* data-based initialization

** DONE gene bias
   CLOSED: [2019-02-27 Wed 15:50]

** TODO image channels?

* DONE [#B] "distribution abstractions"
  CLOSED: [2019-03-01 Fri 17:58]

* DONE how should we handle partially included spots in an image patch?
  CLOSED: [2019-02-28 Thu 18:05]
  note that the data assumes that we predict expression values over the entire spot.
  right now, the network needs to overpredict expression on the visible area.

  - one possibility is to simply drop spots that aren't fully contained in the image patch.
  - we could also interpolate new expression values.
    the problem with that is that the visible part of the patch may have an entirely different expression vector.

* DONE [#A] factorize after summing inside spots
  CLOSED: [2019-04-01 Mon 17:43]
  can we even get the factorization working? :/
  if it is working in std, there is no reason why it wouldn't work here?

** idea
   two modules:
   1. histonet
   2. std
   histonet computes "r_st" over all pixels, which are summed in each spot.
   factors are then convolved similar to std.
   the expression emission would in effect be an amortized std model, where the guide is also informed by histology.

* TODO [#B] data augmentation

* DONE [#B] multiple datasets
  CLOSED: [2019-04-01 Mon 17:43]

* TODO [#C] try out different image likelihoods
  for example,

  - channel covariance
  - spatial covariance

* DONE [#B] add batchnorms?
  CLOSED: [2019-02-28 Thu 18:06]

* DONE [#C] improve logging
  CLOSED: [2019-03-01 Fri 17:57]
  - timestamps

* DONE [#C] improve code structure
  CLOSED: [2019-04-01 Mon 17:44]

** code duplication
   ~train.py~ and ~analyze.py~ both compute spot-wise rates (summing inside spots)

* DONE [#B] log version
  CLOSED: [2019-04-01 Mon 17:44]

* DONE [#B] compute DKL analytically if possible
  CLOSED: [2019-04-23 Tue 15:23]

* TODO [#A] add support for drawing multiple monte carlo samples

* TODO [#A] make priors N(0,*1*)

* DONE [#A] deal with cuda oom more gracefully
  CLOSED: [2019-04-23 Tue 17:29]
